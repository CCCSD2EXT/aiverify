import { prepareChecklistExportData } from "./exportUtil.js";
import { importJson, jsonToChecklistSubmissions, extractChecklistData } from "./importUtils.js";

export const getConfigFiles = () => {
  const configKeys = [
    'accountability',
    'data_governance',
    'explainability',
    'fairness',
    'human_agency_oversight',
    'inclusive_growth_soc_env',
    'organisational_considerations',
    'reproducibility',
    'robustness',
    'safety',
    'security',
    'transparency'
  ];

const configFiles = {};
configKeys.forEach(key => {
try {
configFiles[`config_${key}`] = require(`./config_${key}.ts`).config;
} catch (err) {
console.error(`Failed to load config file for ${key}:`, err);
}
});

return configFiles;
};

export async function prepareExportData(groupName, checklists) {
  try {
    // Get the config files
    const configFiles = getConfigFiles();

    // Use the function to prepare the Excel workbook definition
    const workbookDefinition = await prepareChecklistExportData(
      groupName,
      checklists,
      configFiles
    );

    return workbookDefinition;

} catch (error) {
console.error("Error preparing export data:", error);
return null;
}
}

export const mdxImportJson = importJson;
export const mdxJsonToChecklistSubmissions = jsonToChecklistSubmissions;
export const mdxExtractChecklistData = extractChecklistData;

export function ExportProcessChecklists(props) {
  const { groupName, checklists } = props;

return (

<div style={{ padding: "8px", color: "#666", fontSize: "14px" }}>
  <div>Export component is ready. This renderer is for preview only.</div>
  <div>Group: {groupName}</div>
  <div>Checklists: {checklists?.length || 0} items</div>
</div>
); }
